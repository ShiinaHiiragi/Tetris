<!DOCTYPE HTML>

<html>

<head>
  <title>Tetris</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Dependency Include Here -->
  <link href="./semantic/dist/semantic.min.css" rel="stylesheet" type="text/css">
  <script src="./semantic/dist/semantic.min.js"></script>

  <!-- Customized Resources -->
  <link rel="stylesheet" type="text/css" href="tetris.css">
  <style>
    .menu-title {
      position: absolute;
      width: 72%;
      height: 24vh;
      top: 16vh;
      left: 14%;
      font-size: 16vh;
      text-align: center;
      color: rgba(33, 37, 41, 0.5);
    }

    #menu-text {
      user-select: none;
      line-height: 24vh;
      margin-bottom: 0;
    }

    #menu-button-panel {
      position: absolute;
      width: 100%;
      top: 48vh;
    }

    #menu-button {
      width: 32vh;
      margin-left: calc((100% - 32vh) / 2);
    }
  </style>
</head>

<body>
  <div class="overlay"></div>
  <div class="panel" id="panel">
    <div class="menu-title">
      <p id="menu-text">TETRIS</p>
    </div>
    <div class="ui container" id="menu-button-panel">
      <div class="ui vertical buttons" id="menu-button"></div>
    </div>
  </div>

  <script>
    const electron = require("electron");
    const remote = electron.remote;
    const fs = require("fs");
    var Setting = JSON.parse(fs.readFileSync("src/setting.json"));
    var titleColor = rgbToRGBA(Setting.color[Math.floor(Math.random() * 7 + 1)], 0.6);
    var menuButton = document.getElementById("menu-button");
    var menuText = document.getElementById("menu-text");

    document.body.style.backgroundImage = "url('src/img/bg.jpg')";
    menuText.innerText = "TETRIS";
    menuText.style.color = titleColor;
    addButton(menuButton, "Sprint", "enterTetris(true)");
    addButton(menuButton, "Marathon", "enterTetris(false)");
    addButton(menuButton, "Setting", "location.reload()");
    addButton(menuButton, "Exit", "remote.app.quit()");

    function enterTetris(mode)
    {
      Setting.sprintMode = mode;
      fs.writeFileSync("src/setting.json", JSON.stringify(Setting));
      document.location.href = "tetris.html";
    }

    function rgbToRGBA(rgb, opacity)
    {
      var rgbArray = rgb.match(/-?([1-9]\d*(\.\d*)*|0\.[1-9]\d*)/g);
      for (var index= 0; index < rgbArray.length; index += 1)
        rgbArray[index] = Number(rgbArray[index]);
      return `rgba(${rgbArray[0]}, ${rgbArray[1]}, ${rgbArray[2]}, ${opacity})`;
    }

    function addButton(div, text, func)
    {
      var newButton = document.createElement("button");
      newButton.className = "ui button";
      newButton.style.borderRadius = "0";
      newButton.setAttribute("onclick", func);
      newButton.innerText = text;
      div.append(newButton);
    }
  </script>
</body>

</html>